<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Hooks | Axe API</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/logo.png">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/icons/apple-touch-icon-152x152.png">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#3eaf7c">
    <script async="true" src="https://www.googletagmanager.com/gtag/js?id=G-1HBM031QWE"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-1HBM031QWE');
      </script>
    <meta name="description" content="The fastest way to create Rest API, by defining database models and relations.">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/icons/msapplication-icon-144x144.png">
    <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/assets/css/0.styles.009fede8.css" as="style"><link rel="preload" href="/assets/js/app.e401bdcc.js" as="script"><link rel="preload" href="/assets/js/2.c9fec1e4.js" as="script"><link rel="preload" href="/assets/js/12.da515be1.js" as="script"><link rel="prefetch" href="/assets/js/10.3ca732c3.js"><link rel="prefetch" href="/assets/js/11.6e1ef068.js"><link rel="prefetch" href="/assets/js/13.5b4654c6.js"><link rel="prefetch" href="/assets/js/14.d2ec3cba.js"><link rel="prefetch" href="/assets/js/15.f642973d.js"><link rel="prefetch" href="/assets/js/16.57a4b858.js"><link rel="prefetch" href="/assets/js/17.55c268b2.js"><link rel="prefetch" href="/assets/js/18.c267f0ba.js"><link rel="prefetch" href="/assets/js/19.33518c90.js"><link rel="prefetch" href="/assets/js/20.dc396ee5.js"><link rel="prefetch" href="/assets/js/21.a9a345c2.js"><link rel="prefetch" href="/assets/js/22.e607705f.js"><link rel="prefetch" href="/assets/js/23.29319764.js"><link rel="prefetch" href="/assets/js/24.76d5e167.js"><link rel="prefetch" href="/assets/js/25.6f0d6edb.js"><link rel="prefetch" href="/assets/js/26.80581e44.js"><link rel="prefetch" href="/assets/js/27.ec91427f.js"><link rel="prefetch" href="/assets/js/28.8f4627b5.js"><link rel="prefetch" href="/assets/js/29.db034970.js"><link rel="prefetch" href="/assets/js/3.0cb6f05e.js"><link rel="prefetch" href="/assets/js/30.dab50f00.js"><link rel="prefetch" href="/assets/js/31.e3e98325.js"><link rel="prefetch" href="/assets/js/32.1567e6db.js"><link rel="prefetch" href="/assets/js/33.399427b9.js"><link rel="prefetch" href="/assets/js/34.b2aedc1a.js"><link rel="prefetch" href="/assets/js/4.d5a70b0f.js"><link rel="prefetch" href="/assets/js/5.29eb46f3.js"><link rel="prefetch" href="/assets/js/6.3571f1fd.js"><link rel="prefetch" href="/assets/js/7.c56d85ae.js"><link rel="prefetch" href="/assets/js/8.586e27a8.js"><link rel="prefetch" href="/assets/js/9.32fbefad.js">
    <link rel="stylesheet" href="/assets/css/0.styles.009fede8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="inner"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Axe API</span></a> <div class="links"><nav class="nav-links can-hide"><div class="nav-item"><a href="https://github.com/axe-api/axe-api" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/axe-api/axe-magic" target="_blank" rel="noopener noreferrer" class="nav-link external">
  CLI
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="/cookbooks/" class="nav-link">Cookbooks</a></div><div class="nav-item"><a href="https://sonarcloud.io/dashboard?id=axe-api_axe-api" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Sonarcloud
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/axe-api/axe-api/releases" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Releases
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div></div></div></header> <div class="sidebar-mask"></div> <div class="docs-layout"><aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://github.com/axe-api/axe-api" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/axe-api/axe-magic" target="_blank" rel="noopener noreferrer" class="nav-link external">
  CLI
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="/cookbooks/" class="nav-link">Cookbooks</a></div><div class="nav-item"><a href="https://sonarcloud.io/dashboard?id=axe-api_axe-api" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Sonarcloud
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/axe-api/axe-api/releases" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Releases
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Getting Started</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Architecture</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Basics</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Advanced</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/advanced/hooks/" aria-current="page" class="active sidebar-link">Hooks</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/advanced/hooks/#why" class="sidebar-link">Why?</a></li><li class="sidebar-sub-header"><a href="/advanced/hooks/#hooks-2" class="sidebar-link">Hooks</a></li><li class="sidebar-sub-header"><a href="/advanced/hooks/#events" class="sidebar-link">Events</a></li><li class="sidebar-sub-header"><a href="/advanced/hooks/#request-lifecycle" class="sidebar-link">Request Lifecycle</a></li><li class="sidebar-sub-header"><a href="/advanced/hooks/#parameters" class="sidebar-link">Parameters</a></li><li class="sidebar-sub-header"><a href="/advanced/hooks/#special-parameters" class="sidebar-link">Special Parameters</a></li></ul></li><li><a href="/advanced/ioc/" class="sidebar-link">IoC</a></li><li><a href="/advanced/custom-routes/" class="sidebar-link">Custom Routes</a></li><li><a href="/advanced/docs/" class="sidebar-link">Documentation</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Database</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Security</span> <span class="arrow right"></span></p> <!----></section></li><li><a href="/testing/" class="sidebar-link">Testing</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="hooks"><a href="#hooks" class="header-anchor">#</a> Hooks</h1> <h2 id="why"><a href="#why" class="header-anchor">#</a> Why?</h2> <p>In the real world, everybody needs more than saving and listing records. Everybody needs more complicated logic in their code. <strong>Axe API</strong> provides you a basic structure of an API. It provides you basic CRUD actions with dynamic query options. But when you need custom logic, you will not be alone. <strong>Axe API</strong> provides you <em>escape points</em> to extend your HTTP requests and manipulate them.</p> <p>There are two different ways to add your business logic; <strong>Hooks</strong> and <strong>Events</strong>. They are almost the same except one differences. We are going to explain it later. But first, we should understand what the <strong>hook</strong> is.</p> <h2 id="hooks-2"><a href="#hooks-2" class="header-anchor">#</a> Hooks</h2> <p>Axe API automatically handles your API. It creates routes, handles HTTP requests, performs the request, and creates a response. But it doesn't just do these. It also has some escape points. With those, you can add your code to the HTTP Request-Response cycle.</p> <p>For example, let's assume that you want to hash the user's password in user creation. How can we do this? First, we should create a file that is called <code>UserHooks.js</code> under <code>app/Hooks</code>.</p> <p><code>UserHooks.js</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> bcrypt <span class="token keyword">from</span> <span class="token string">&quot;bcrypt&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">onBeforeInsert</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> formData <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// Genering salt</span>
  formData<span class="token punctuation">.</span>password_salt <span class="token operator">=</span> bcrypt<span class="token punctuation">.</span><span class="token function">genSaltSync</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// Hashing the password</span>
  formData<span class="token punctuation">.</span>password <span class="token operator">=</span> bcrypt<span class="token punctuation">.</span><span class="token function">hashSync</span><span class="token punctuation">(</span>
    formData<span class="token punctuation">.</span>password<span class="token punctuation">,</span>
    formData<span class="token punctuation">.</span>password_salt
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token punctuation">{</span> onBeforeInsert <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>In the code above, we used <a href="https://www.npmjs.com/package/bcrypt" target="_blank" rel="noopener noreferrer">bcrypt<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> library to hash the user's password. By accessing form data, hashing the user's password is easy.</p> <p><strong>But can this function be executed? Yes!</strong> In the booting process, Axe API tries to discover what kind of hooks and events have been written. For a model called <code>User</code>, if you create a hook which is called <code>UserHook</code>, Axe API accepts that <code>UserHooks</code> is the hook definition file for the model <code>User</code>. In the HTTP request processing time, if there is any hook that has been written, Axe API calls that hook.</p> <p>This feature gives us very important flexibility. First of all, you can add any logic by the parameters which Axe API passed. Secondly, the hook functions are almost isolated. It means that writing unit tests about them is very easy.</p> <p>This structure is almost the same for Events, too.</p> <h2 id="events"><a href="#events" class="header-anchor">#</a> Events</h2> <p>The main difference between <strong>Hooks</strong> and <strong>Events</strong> is; events are <strong>asynchronous</strong>. It means that if you are using an <strong>hooks</strong> and handle the request, the HTTP request cycle waits for you to do your task. But in events, when you handle the event, the HTTP requests cycle keeps working and returns a response. So, if you want to send an e-mail to the user, you should use <strong>Events</strong>. On the other hand, if you want to be involved in the query or any business logic in the HTTP request cycle, you should use <strong>Hooks</strong>.</p> <p>Using <strong>Events</strong> is very easy, almost same with the hooks. There is only one different thing in usage. Which is creating the event file under the <code>app/Events</code> folders.</p> <p><code>app/Events/UserEvents.js</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">onAfterInsert</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> formData <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// You can send an email to the user in here...</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token punctuation">{</span> onAfterInsert <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="request-lifecycle"><a href="#request-lifecycle" class="header-anchor">#</a> Request Lifecycle</h2> <p>To write hook or event functions, you should understand the Axe API HTTP Request's lifecycles. Before doing that, we are going to define basic facts.</p> <h3 id="definitions"><a href="#definitions" class="header-anchor">#</a> Definitions</h3> <ul><li>Handlers are types of model processing. There are five basic handlers in Axe API
<ul><li>INSERT</li> <li>PAGINATE</li> <li>SHOW</li> <li>UPDATE</li> <li>DELETE</li></ul></li> <li>Two different <strong>actions</strong> can be done on the data, in a handler;
<ul><li>Manipulating</li> <li>Fetching</li></ul></li> <li>Some of handlers do only one <strong>action</strong>, but some of them do both.
<ul><li>Insert: Manipulating</li> <li>Update: Fetching, Manipulating</li> <li>Delete: Fetching, Manipulating</li> <li>Show: Fetching</li> <li>Paginate: Fetching</li></ul></li></ul> <p>We can show which handler do what actions in a table;</p> <table><thead><tr><th>Handler</th> <th>Manipulating</th> <th>Fetching</th></tr></thead> <tbody><tr><td>INSERT</td> <td>✓</td> <td></td></tr> <tr><td>PAGINATE</td> <td></td> <td>✓</td></tr> <tr><td>SHOW</td> <td></td> <td>✓</td></tr> <tr><td>UPDATE</td> <td>✓</td> <td>✓</td></tr> <tr><td>DELETE</td> <td>✓</td> <td>✓</td></tr></tbody></table> <p>These values are important because we are using that definitions in <em>Request Lifecycle</em>.</p> <h3 id="request-lifecycle-2"><a href="#request-lifecycle-2" class="header-anchor">#</a> Request Lifecycle</h3> <p>In Axe API, we use <strong>Before</strong> and <strong>After</strong> hooks/events to give more flexibility. Also, Axe API calls hooks first. After hooks, it calls events if there any. With this information, we can describe general schema of <em>Request Lifecycle</em>;</p> <ul><li>Axe API start to process HTTP Request</li> <li>Call model-based middlewares</li> <li>Call the handler (INSERT, UPDATE, etc.)</li> <li>Call <strong>Before Fetching</strong> hooks</li> <li>Call <strong>Before Fetching</strong> events</li> <li>Execute <strong>Fetching</strong> action.</li> <li>Call <strong>After Fetching</strong> hooks</li> <li>Call <strong>After Fetching</strong> events</li> <li>Call <strong>Before Manipulating</strong> hooks</li> <li>Call <strong>Before Manipulating</strong> events</li> <li>Execute <strong>Manipulating</strong> action.</li> <li>Call <strong>After Manipulating</strong> hooks</li> <li>Call <strong>After Manipulating</strong> events</li> <li>Send the response.</li></ul> <p>This is the basic standard of our calling Hooks/Events system. By the type of handler, you can add many different hooks/events.</p> <h3 id="full-hooks-events-table"><a href="#full-hooks-events-table" class="header-anchor">#</a> Full Hooks/Events Table</h3> <p>The following table describes all possible hooks by handler types.</p> <table><thead><tr><th>Handler</th> <th>Manipulating</th> <th>Fetching</th></tr></thead> <tbody><tr><td>INSERT</td> <td><code>onBeforeInsert</code>/<code>onAfterInsert</code></td> <td></td></tr> <tr><td>PAGINATE</td> <td></td> <td><code>onBeforePaginate</code>/<code>onAfterPaginate</code></td></tr> <tr><td>ALL</td> <td></td> <td><code>onBeforeAll</code>/<code>onAfterAll</code></td></tr> <tr><td>SHOW</td> <td></td> <td><code>onBeforeShow</code>/<code>onAfterShow</code></td></tr> <tr><td>UPDATE</td> <td><code>onBeforeUpdate</code>/<code>onAfterUpdate</code></td> <td><code>onBeforeUpdateQuery</code>/<code>onAfterUpdateQuery</code></td></tr> <tr><td>PATCH</td> <td><code>onBeforeUpdate</code>/<code>onAfterUpdate</code></td> <td><code>onBeforeUpdateQuery</code>/<code>onAfterUpdateQuery</code></td></tr> <tr><td>DELETE</td> <td><code>onBeforeDelete</code>/<code>onAfterDelete</code></td> <td><code>onBeforeDeleteQuery</code>/<code>onAfterUpdateQuery</code></td></tr></tbody></table> <h2 id="parameters"><a href="#parameters" class="header-anchor">#</a> Parameters</h2> <p>There are some parameters which you can use in a hook or event function.</p> <h3 id="common-parameters"><a href="#common-parameters" class="header-anchor">#</a> Common Parameters</h3> <ul><li><code>request</code>: Request object of <a href="https://expressjs.com/en/4x/api.html#req" target="_blank" rel="noopener noreferrer">Expresss<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><code>response</code>: Response object of <a href="https://expressjs.com/en/4x/api.html#res" target="_blank" rel="noopener noreferrer">Expresss<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><code>model</code>: Current model instance. For example; <code>User.js</code>.</li> <li><code>database</code>: Database connection instance. For example <a href="http://knexjs.org/#Installation-client" target="_blank" rel="noopener noreferrer">Knex.js<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><code>relation</code>: The relation definition if the route is a related route (For example <code>api/users/:userId/posts</code>).</li> <li><code>parentModel</code>: The parent model instance if the route is a related route (For example <code>api/users/:userId/posts</code>).</li></ul> <h2 id="special-parameters"><a href="#special-parameters" class="header-anchor">#</a> Special Parameters</h2> <ul><li><code>query</code>: The Knex.js' <a href="http://knexjs.org/#Builder-wheres" target="_blank" rel="noopener noreferrer">query instance<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</li> <li><code>conditions</code>: The conditions which has been send by the HTTP client to filter data.</li> <li><code>item</code>: The current record. (For example; the item that will be updated.)</li> <li><code>result</code>: The query result. (For example SHOW and PAGINATE handlers.)</li> <li><code>formData</code>: The data has been sent by HTTP client to create or update row.</li></ul> <p>We can show all special parameters in the following table;</p> <table><thead><tr><th>Hook/Events Name</th> <th>Parameters</th></tr></thead> <tbody><tr><td>onBeforeInsert</td> <td>formData</td></tr> <tr><td>onBeforeUpdateQuery</td> <td>query</td></tr> <tr><td>onBeforeUpdate</td> <td>item, formData, query,</td></tr> <tr><td>onBeforeDeleteQuery</td> <td>query</td></tr> <tr><td>onBeforeDelete</td> <td>query</td></tr> <tr><td>onBeforePaginate</td> <td>conditions, query</td></tr> <tr><td>onBeforeAll</td> <td>conditions, query</td></tr> <tr><td>onBeforeShow</td> <td>conditions, query</td></tr> <tr><td>onAfterInsert</td> <td>formData, item</td></tr> <tr><td>onAfterUpdateQuery</td> <td>item, query</td></tr> <tr><td>onAfterUpdate</td> <td>item, formData, query</td></tr> <tr><td>onAfterDeleteQuery</td> <td>query, item</td></tr> <tr><td>onAfterDelete</td> <td>item</td></tr> <tr><td>onAfterPaginate</td> <td>results, conditions, query</td></tr> <tr><td>onAfterAll</td> <td>results, conditions, query</td></tr> <tr><td>onAfterShow</td> <td>item, conditions, query</td></tr></tbody></table></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/basics/errors/" class="prev">
          Error Handling
        </a></span> <span class="next"><a href="/advanced/ioc/">
          IoC
        </a>
        →
      </span></p></div> </main></div></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.e401bdcc.js" defer></script><script src="/assets/js/2.c9fec1e4.js" defer></script><script src="/assets/js/12.da515be1.js" defer></script>
  </body>
</html>
